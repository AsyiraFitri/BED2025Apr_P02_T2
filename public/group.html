<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Group Details</title>
  <link rel="stylesheet" href="css/group.css"/>
  <link rel="stylesheet" href="css/style.css"/>
</head>
<body>
  <!-- Main Container -->
  <div class="container">
    <!-- Back Arrow -->
    <div class="back-arrow">
      <button class="back-btn" onclick="window.location.href = 'community.html'">‚Üê</button>
    </div>
    
    <!-- Group Header -->
    <div class="group-header">
      <div class="group-title-section">
        <div>
          <h1 class="group-title" id="groupTitle">Loading...</h1>
          <div class="group-stats" id="noMembers">26 members</div>
        </div>
        <button class="settings-btn" onclick="openSettingsModal()">‚öôÔ∏è</button>
      </div>
    </div>

    <!-- Content Area -->
    <div class="content-area">
      <!-- Sidebar -->
      <div class="sidebar">
        <div id="channelsSidebar">
          <!-- Channels will be loaded here dynamically -->
        </div>
      </div>

      <!-- Main Content -->
      <div class="main-content" id="mainContent">
        <!-- The eventsChannel div is managed by JS and should only be visible when the events channel is selected. -->
        <div id="eventsChannel" style="display:none;"></div>
      </div>
    </div>
  </div>

  <!-- Settings Modal -->
  <div class="settings-modal" id="settingsModal" style="display: none;">
    <div class="settings-content">
      <div class="settings-content-inner">
        <div class="settings-header">
          <h2 class="settings-title">üß∂ Knitting & Crochet Circle</h2>
          <button class="settings-close" onclick="closeSettingsModal()">√ó</button>
        </div>

        <div class="description-section">
          <div class="description-title">Group Description:</div>
          <div class="description-text" id="descriptionText">Join fellow yarn lovers to share patterns, techniques, and handmade projects. Whether you're a beginner or an experienced crafter, everyone is welcome to stitch and socialize.</div>
          <textarea class="description-textarea hidden" id="descriptionTextarea">Join fellow yarn lovers to share patterns, techniques, and handmade projects. Whether you're a beginner or an experienced crafter, everyone is welcome to stitch and socialize.</textarea>
          <div class="description-actions">
              <button class="description-btn edit-btn" id="editDescBtn" onclick="editDescription()">Edit</button>
              <button class="description-btn save-btn hidden" id="saveDescBtn" onclick="saveDescription()">Save</button>
              <button class="description-btn cancel-btn hidden" id="cancelDescBtn" onclick="cancelDescription()">Cancel</button>
          </div>
        </div>
        
        <div class="members-section">
          <div class="members-title">Members list:</div>
          <ul class="members-list">
          </ul>
        </div>

        <!-- Channel Management Section (Owner/Admin Only) -->
        <div class="channels-section" id="channelsSection" style="display: none;">
          <div class="channels-title">Manage Channels:</div>
          <div class="add-channel-form">
            <input type="text" id="channelNameInput" placeholder="Enter channel name" maxlength="20">
            <button class="channel-btn add-channel-btn" onclick="addChannel()">Add Channel</button>
          </div>
          <ul class="channels-list" id="channelsList">
            <!-- Channels will be loaded here -->
          </ul>
        </div>

        <div class="action-section" id="leaveCommunityBtn">
          <div class="action-question">Would you like to leave the community?</div>
          <button class="action-btn leave-btn" onclick="leaveCommunity()">Leave</button>
        </div>

        <div class="action-section" id="deleteCommunityBtn">
          <div class="action-question">Would you like to delete the community?</div>
          <button class="action-btn delete-btn" onclick="deleteCommunity()">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Event Modal Template (hidden, for JS injection) -->
  <div id="eventModalTemplate" style="display:none;">
    <form id="eventCreateForm">
      <h2 style="margin-bottom:16px;text-align:center;">Create Event</h2>
      <div style="margin-bottom:12px;">
        <label>Event Title</label><br>
        <input type="text" id="eventTitleInput" style="width:100%;padding:8px;margin-top:4px;" required maxlength="100">
      </div>
      <div style="margin-bottom:12px;">
        <label>Event Description</label><br>
        <textarea id="eventDescriptionInput" style="width:100%;padding:8px;margin-top:4px;" required maxlength="500"></textarea>
      </div>
      <div style="margin-bottom:12px;">
        <label>Event Date</label><br>
        <input type="date" id="eventDateInput" style="width:100%;padding:8px;margin-top:4px;" required>
      </div>
      <div style="margin-bottom:12px;">
        <label>Start Time</label><br>
        <input type="time" id="eventStartTimeInput" style="width:100%;padding:8px;margin-top:4px;" required>
      </div>
      <div style="margin-bottom:12px;">
        <label>End Time</label><br>
        <input type="time" id="eventEndTimeInput" style="width:100%;padding:8px;margin-top:4px;" required>
      </div>
      <div style="margin-bottom:16px;">
        <label>Location</label><br>
        <input type="text" id="eventLocationInput" style="width:100%;padding:8px;margin-top:4px;" required maxlength="100">
      </div>
      <button type="submit" style="width:100%;padding:10px 0;background:#007bff;color:#fff;border:none;border-radius:6px;font-size:16px;">Create Event</button>
    </form>
  </div>

  <!-- Firebase v9+ compatibility bundle -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="js/group.js"></script>
  <script src="js/community.js"></script>
</body>
</html>